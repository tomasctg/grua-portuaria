<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type0" id="S2T0U3">x</span>,<span class="var type0" id="S3T0U4">res</span>] = solve_vel_prof</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line">rng(5489,<span class="string">'twister'</span>) <span class="comment">% For reproducibility</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T1:U1"><span class="var type1" id="S5T1U14">xdata</span> = <span class="mxinfo " id="T1:U3"><span class="mxinfo " id="T2:U4">-2</span>*<span class="mxinfo " id="T1:U5">log(<span class="mxinfo " id="T1:U6">rand(100,1)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T1:U7"><span class="var type1" id="S8T1U26">ydata</span> = <span class="mxinfo " id="T1:U9">(<span class="mxinfo " id="T1:U10"><span class="mxinfo " id="T1:U11">ones(<span class="mxinfo " id="T2:U12">100</span>,1)</span> + <span class="mxinfo " id="T1:U13"><span class="mxinfo " id="T2:U14">.1</span>*<span class="mxinfo " id="T1:U15">randn(100,1)</span></span></span>) + <span class="mxinfo " id="T1:U16">(<span class="mxinfo " id="T1:U17"><span class="mxinfo " id="T1:U18"><span class="mxinfo " id="T2:U19">3</span>*<span class="mxinfo " id="T1:U20">ones(<span class="mxinfo " id="T2:U21">100</span>,1)</span></span>+<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line">    <span class="mxinfo " id="T1:U22"><span class="mxinfo " id="T2:U23">0.5</span>*<span class="mxinfo " id="T1:U24">randn(100,1)</span></span></span>).*<span class="mxinfo " id="T1:U25">exp(<span class="mxinfo " id="T1:U26">(<span class="mxinfo " id="T1:U27">-(<span class="mxinfo " id="T1:U28"><span class="mxinfo " id="T1:U29"><span class="mxinfo " id="T2:U30">2</span>*<span class="mxinfo " id="T1:U31">ones(<span class="mxinfo " id="T2:U32">100</span>,1)</span></span>+<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo " id="T1:U33"><span class="mxinfo " id="T2:U34">0.5</span>*<span class="mxinfo " id="T1:U35">randn(100,1)</span></span></span>)</span>).*<span class="var type1" id="S5T1U74">xdata</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T3:U37"><span class="var type1" id="S12T3U77">predicted</span> = <span class="mxinfo " id="T3:U39">@(a) (a(1)*ones(100,1)+a(2)*exp(-a(3)*<span class="var type0" id="S5T0U102">xdata</span>) - <span class="var type0" id="S8T0U103">ydata</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="var type0" id="S13T0U106">options</span> = <span class="message error" id="M1F1C">optimoptions(<span class="mxinfo " id="T8:U40"><span class="string">'lsqnonlin'</span></span>,<span class="mxinfo " id="T8:U41"><span class="string">'Algorithm'</span></span>,<span class="mxinfo " id="T9:U42"><span class="string">'levenberg-marquardt'</span></span>,<span class="mxinfo " id="T10:U43"><span class="string">'Display'</span></span>,<span class="mxinfo " id="T11:U44"><span class="string">'off'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T12:U45"><span class="var type1" id="S15T12U116">a0</span> = <span class="mxinfo " id="T12:U47">[<span class="mxinfo " id="T2:U48">2</span>;<span class="mxinfo " id="T2:U49">2</span>;<span class="mxinfo " id="T2:U50">2</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T13:U51"><span class="var type1" id="S16T13U126">lb</span> = <span class="mxinfo " id="T13:U53">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo " id="T13:U54"><span class="var type1" id="S17T13U131">ub</span> = <span class="mxinfo " id="T13:U56">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">[<span class="var type0" id="S2T0U137"><span class="message error" id="M3F1C">x</span></span>,<span class="var type0" id="S3T0U138"><span class="message error" id="M4F1C">res</span></span>] = lsqnonlin(<span class="var type1" id="S12T3U141">predicted</span>,<span class="var type1" id="S15T12U142">a0</span>,<span class="var type1" id="S16T13U143">lb</span>,<span class="var type1" id="S17T13U144">ub</span>,<span class="var type0" id="S13T0U145"><span class="message error" id="M2F1C">options</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="comment">% function x = solve_vel_prof(A,B,C) </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="comment">% x0 = [1,1,1];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"><span class="comment">% x = lsqnonlin(@root3d,x0,zeros(size(x0))); </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"><span class="comment">%     function F = root3d(x)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="comment">%         F = [];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="comment">%         F(1) = x(1)*x(2) + x(1)*x(3) - A;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="comment">%         F(2) = 2*x(3) + x(2) -B;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="comment">%         F(3) = x(1)/x(3) - C;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="comment">% end</span></span></span>
</pre>
</body>
</html>
